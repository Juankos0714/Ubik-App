server:
  port: 8080

spring:
  application:
    name: payments-checkout-pro

  r2dbc:
    url: ${R2DBC_URL:r2dbc:postgresql://localhost:5432/payments}
    username: ${DB_USERNAME:payments_user}
    password: ${DB_PASSWORD:payments_pass}
    pool:
      initial-size: 5
      max-size: 20
      max-idle-time: 30m

  flyway:
    enabled: true
    url: ${DB_URL:jdbc:postgresql://localhost:5432/payments}
    user: ${DB_USERNAME:payments_user}
    password: ${DB_PASSWORD:payments_pass}
    locations: classpath:db/migration
    baseline-on-migrate: true

  jackson:
    serialization:
      write-dates-as-timestamps: false

mercadopago:
  access-token: ${MP_ACCESS_TOKEN}
  webhook-secret: ${MP_WEBHOOK_SECRET}
  notification-url: ${MP_NOTIFICATION_URL}
  back-urls:
    success: ${MP_BACK_URL_SUCCESS}
    pending: ${MP_BACK_URL_PENDING}
    failure: ${MP_BACK_URL_FAILURE}
  webhook-skew-millis: 300000
  connection-timeout-ms: 2000
  socket-timeout-ms: 5000

app:
  internal-api-key: ${APP_INTERNAL_API_KEY:changeme}
  rate-limit:
    writes-per-minute: 30
    webhook-per-minute: 120

management:
  endpoints:
    web:
      exposure:
        include: health,info,metrics,prometheus
  endpoint:
    health:
      show-details: always
  prometheus:
    metrics:
      export:
        enabled: true

logging:
  level:
    com.acme.payments: INFO
    org.springframework.data.r2dbc: WARN